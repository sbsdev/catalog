<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>catalog.layout.fop documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Kati</span> <span class="project-version">0.6</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>catalog</span></div></div></li><li class="depth-2 branch"><a href="catalog.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-2 branch"><a href="catalog.issue.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>issue</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>layout</span></div></div></li><li class="depth-3 branch"><a href="catalog.layout.common.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>common</span></div></a></li><li class="depth-3 branch"><a href="catalog.layout.dtbook.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dtbook</span></div></a></li><li class="depth-3 branch current"><a href="catalog.layout.fop.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fop</span></div></a></li><li class="depth-3 branch"><a href="catalog.layout.obi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>obi</span></div></a></li><li class="depth-3"><a href="catalog.layout.text.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>text</span></div></a></li><li class="depth-2 branch"><a href="catalog.repl.html"><div class="inner"><span class="tree" style="top: -176px;"><span class="top" style="height: 185px;"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-2 branch"><a href="catalog.validation.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>validation</span></div></a></li><li class="depth-2 branch"><a href="catalog.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li><li class="depth-2 branch"><a href="catalog.vubis.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>vubis</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></div></li><li class="depth-3 branch"><a href="catalog.web.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-3 branch"><a href="catalog.web.layout.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>layout</span></div></a></li><li class="depth-3 branch"><a href="catalog.web.main.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>main</span></div></a></li><li class="depth-3"><a href="catalog.web.views.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>views</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="catalog.layout.fop.html#var-document"><div class="inner"><span>document</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-document-sexp"><div class="inner"><span>document-sexp</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-entries-sexp"><div class="inner"><span>entries-sexp</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-entry-heading-sexp"><div class="inner"><span>entry-heading-sexp</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-entry-sexp"><div class="inner"><span>entry-sexp</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-font-colors"><div class="inner"><span>font-colors</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-format-sexp"><div class="inner"><span>format-sexp</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-generate-document"><div class="inner"><span>generate-document</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-generate-pdf.21"><div class="inner"><span>generate-pdf!</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-genre-sexp"><div class="inner"><span>genre-sexp</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-heading"><div class="inner"><span>heading</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-issue-colors"><div class="inner"><span>issue-colors</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-issue-indent"><div class="inner"><span>issue-indent</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-md-to-fop"><div class="inner"><span>md-to-fop</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-style"><div class="inner"><span>style</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-subgenre-sexp"><div class="inner"><span>subgenre-sexp</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-subgenres-sexp"><div class="inner"><span>subgenres-sexp</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-to-fop"><div class="inner"><span>to-fop</span></div></a></li><li class="depth-1"><a href="catalog.layout.fop.html#var-toc"><div class="inner"><span>toc</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">catalog.layout.fop</h1><div class="doc"><div class="markdown"><p>Functionality to render a tree of catalog items as accessible PDF</p></div></div><div class="public anchor" id="var-document"><h3>document</h3><div class="usage"><code>(document items fmt year issue editorial recommendations &amp; {:keys [description], :as args})</code></div><div class="doc"><div class="markdown"><p>Return the xsl-fo XML for a catalog document. To produce PDF pass this XML to a xsl-fo processor. <code>items</code> contains a tree of catalog entries. <code>fmt</code> is the kind of format we want the catalog in (see <a href="catalog.layout.fop.html#var-document-sexp">document-sexp</a>). <code>year</code> and <code>issue</code> are placed on the coverpage. <code>editorial</code> and <code>recommendations</code> are also placed inside the catalog (at least for some formats). Lastly optional args such as <code>query</code> or <code>customer</code> can be passed. These will be used on the cover page of custom catalogs.</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L912">view source</a></div></div><div class="public anchor" id="var-document-sexp"><h3>document-sexp</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp for a catalog document. Dispatch on the format (<code>fmt</code>) of the requested catalog.</p>
<ul>
  <li><code>:all-formats</code> a standard catalog</li>
  <li><code>:grossdruck</code> a large print catalog using a big font</li>
  <li><code>:hörbuch</code> a catalog used for narrators to read the catalog with some specific sorting requirements</li>
  <li><code>:hörfilm</code> a catalog with all hörfile for a given year</li>
  <li><code>:ludo</code> a catalog with all games for a given year</li>
  <li><code>:taktilesbuch</code> a catalog with all tactile books for a given year</li>
  <li><code>:custom</code> a catalog with a custom selection of catalog entries specific for a customer</li>
  <li><code>:custom-grossdruck</code> a catalog with a custom selection of catalog entries specific for a customer and in large print</li>
</ul></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L699">view source</a></div></div><div class="public anchor" id="var-entries-sexp"><h3>entries-sexp</h3><div class="usage"><code>(entries-sexp items opts)</code></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp for given <code>items</code> and <code>opts</code></p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L369">view source</a></div></div><div class="public anchor" id="var-entry-heading-sexp"><h3>entry-heading-sexp</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp for a heading for a given item.</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L215">view source</a></div></div><div class="public anchor" id="var-entry-sexp"><h3>entry-sexp</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp for a given item.</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L261">view source</a></div></div><div class="public anchor" id="var-font-colors"><h3>font-colors</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Defines the font colors used on the cover page</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L452">view source</a></div></div><div class="public anchor" id="var-format-sexp"><h3>format-sexp</h3><div class="usage"><code>(format-sexp items fmt level {:keys [with-toc?], :or {with-toc? true}, :as opts})</code></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp for a format</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L405">view source</a></div></div><div class="public anchor" id="var-generate-document"><h3>generate-document</h3><div class="usage"><code>(generate-document items fmt year issue editorial recommendations out)</code></div><div class="doc"><div class="markdown"><p>Return the xsl-fo XML for a catalog document and store it in <code>out</code>. Similar to <a href="catalog.layout.fop.html#var-document">document</a> but additionally stores the XML. Used for debugging.</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L927">view source</a></div></div><div class="public anchor" id="var-generate-pdf.21"><h3>generate-pdf!</h3><div class="usage"><code>(generate-pdf! document out)</code></div><div class="doc"><div class="markdown"><p>Return a pdf in <code>out</code> for given <code>document</code>, which is a string containing xsl-fo XML. The pdf is generated using the <a href="https://xmlgraphics.apache.org/fop/">Apache Fop</a> xsl-fo formatting objects processor.</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L937">view source</a></div></div><div class="public anchor" id="var-genre-sexp"><h3>genre-sexp</h3><div class="usage"><code>(genre-sexp items fmt genre level opts)</code></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp for a genre</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L391">view source</a></div></div><div class="public anchor" id="var-heading"><h3>heading</h3><div class="usage"><code>(heading level path {:keys [path-to-numbers]})</code></div><div class="doc"><div class="markdown"><p>Return a heading block for given <code>level</code> and <code>path</code>.</p>
<p>The last part of <code>path</code> is used as the title of the section. If <code>path</code> is found in <code>path-to-numbers</code> then the heading is numbered. If the last part of path is a keyword then this is looked up in the translations and the actual translation is used as the title instead.</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L56">view source</a></div></div><div class="public anchor" id="var-issue-colors"><h3>issue-colors</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Defines the bg colors used for the cover page of the respective issues</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L459">view source</a></div></div><div class="public anchor" id="var-issue-indent"><h3>issue-indent</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Mapping of indents for each issue.</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L489">view source</a></div></div><div class="public anchor" id="var-md-to-fop"><h3>md-to-fop</h3><div class="usage"><code>(md-to-fop markdown path opts)</code></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp for given <code>markdown</code> at <code>path</code> with <code>opts</code>.</p>
<p>The <code>markdown</code> is parsed, converted to a clojure data structure and finally converted to a hiccup style sexp by the <a href="catalog.layout.fop.html#var-to-fop">to-fop</a> multimethod.</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L154">view source</a></div></div><div class="public anchor" id="var-style"><h3>style</h3><div class="usage"><code>(style class)</code><code>(style class attrs)</code></div><div class="doc"><div class="markdown"><p>Return a map of style attributes for given <code>class</code>. The attributes are looked up in the <code>*stylesheet*</code> dynamic var. Optionally additional <code>attrs</code> can be defined that will be merged with the attrs of given <code>class</code></p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L46">view source</a></div></div><div class="public anchor" id="var-subgenre-sexp"><h3>subgenre-sexp</h3><div class="usage"><code>(subgenre-sexp items fmt genre subgenre level opts)</code></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp for a subgenre</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L378">view source</a></div></div><div class="public anchor" id="var-subgenres-sexp"><h3>subgenres-sexp</h3><div class="usage"><code>(subgenres-sexp items fmt genre level opts)</code></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp for all subgenres for given <code>genre</code></p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L386">view source</a></div></div><div class="public anchor" id="var-to-fop"><h3>to-fop</h3><h4 class="type">multimethod</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp containing the fo markup for given node at <code>path</code> and <code>opts</code>.</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L123">view source</a></div></div><div class="public anchor" id="var-toc"><h3>toc</h3><div class="usage"><code>(toc items path depth {:keys [heading?], :as opts})</code></div><div class="doc"><div class="markdown"><p>Return a hiccup style sexp for a fo TOC for given <code>items</code>, <code>path</code> and <code>depth</code>.</p>
<p>Optionally a TOC heading (the actual value is looked up in the translation map) can be enabled through <code>opts</code>.</p></div></div><div class="src-link"><a href="https://github.com/sbsdev/catalog/blob/v0.6/src/catalog/layout/fop.clj#L196">view source</a></div></div></div></body></html>